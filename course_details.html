<!DOCTYPE html>
<html>

<head>
  <title>Course Details</title>
  <style>
    body {
      font-family: Arial;
      padding: 20px;
    }

    .card {
      border: 1px solid #ccc;
      border-radius: 10px;
      padding: 20px;
      background-color: #f9f9f9;
    }
  </style>
</head>

<body>
  <h2>üìò Course Details</h2>
  <div class="card" id="courseDetails">Loading...</div>
  <br>
  <h3>Leave a Rating or Comment:</h3>
  <select id="rating">
    <option value="">Select Rating</option>
    <option value="1">‚≠ê</option>
    <option value="2">‚≠ê‚≠ê</option>
    <option value="3">‚≠ê‚≠ê‚≠ê</option>
    <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê</option>
    <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
  </select><br><br>

  <textarea id="comment" placeholder="Write a comment..." rows="4" cols="50"></textarea><br><br>

  <button onclick="submitFeedback()">Submit Feedback</button>

  <div id="feedbackSection"></div>

  <a href="student_dashboard.html">‚¨ÖÔ∏è Back to Dashboard</a>

  <script>
    const courseData = JSON.parse(localStorage.getItem("selectedCourse"));

    if (!courseData) {
      document.getElementById("courseDetails").innerText = "No course data found.";
    } else {
      document.getElementById("courseDetails").innerHTML = `
            <h3>${courseData.title}</h3>
            <p><strong>Description:</strong> ${courseData.description}</p>
            <p><strong>Created by:</strong> ${courseData.createdBy}</p>

            ${courseData.video ? `
                <p><strong>Video:</strong></p>
                <video width="100%" height="300" controls>
                <source src="${courseData.video}" type="video/mp4">
                Your browser does not support the video tag.
                </video>
            ` : ''}

            ${courseData.pdf ? `
                <p><strong>PDF:</strong></p>
                <iframe src="${courseData.pdf}" width="100%" height="500px"></iframe>
            ` : ''}

            ${courseData.file ? `
                <p><strong>Downloadable Material:</strong></p>
                <a href="${courseData.file}" target="_blank" download>
                <button>Download File</button>
                </a>
            ` : ''}

            ${courseData.time ? `
            <p><strong>Live Class Time:</strong> ${new Date(courseData.time).toLocaleString()}</p>
            ` : ''}

            `;

    }
    function submitFeedback() {
      const rating = document.getElementById("rating").value;
      const comment = document.getElementById("comment").value;

      if (!rating && !comment) {
        alert("Please add a rating or comment before submitting!");
        return;
      }

      const feedback = JSON.parse(localStorage.getItem("feedback_" + courseData.title)) || [];

      feedback.push({
        student: localStorage.getItem("userEmail"),
        rating,
        comment
      });

      localStorage.setItem("feedback_" + courseData.title, JSON.stringify(feedback));

      alert("Thank you for your feedback!");
      showFeedback();
    }

    // Display feedback
    function showFeedback() {
      const feedbacks = JSON.parse(localStorage.getItem("feedback_" + courseData.title)) || [];
      const feedbackSection = document.getElementById("feedbackSection");

      feedbackSection.innerHTML = "<h3>Feedback:</h3>";
      feedbacks.forEach(f => {
        feedbackSection.innerHTML += `
      <p>‚≠ê ${f.rating || "No Rating"} - "${f.comment || "No Comment"}" by ${f.student}</p>
    `;
      });
    }

    showFeedback(); // Load existing feedbacks when page loads

  </script>
</body>

</html>